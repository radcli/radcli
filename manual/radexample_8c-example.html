<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Radcli library: radexample.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Radcli library<span id="projectnumber">&#160;1.4.0</span>
   </div>
   <div id="projectbrief">A simple radius library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">radexample.c</div></div>
</div><!--header-->
<div class="contents">
<p>This is an example of how to use the radcli API.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Copyright (C) 1995,1996,1997 Lars Fenneberg</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2015 Nikos Mavrogiannopoulos</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * See the file COPYRIGHT for the respective terms and conditions.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include        &lt;config.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include        &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include        &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include        &lt;radcli/radcli.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span>             result;</div>
<div class="line">        <span class="keywordtype">char</span>            username[128];</div>
<div class="line">        <span class="keywordtype">char</span>            passwd[AUTH_PASS_LEN + 1];</div>
<div class="line">        <a id="_a0" name="_a0"></a><a class="code hl_struct" href="structrc__value__pair.html">VALUE_PAIR</a>      *send, *received;</div>
<div class="line">        uint32_t        service;</div>
<div class="line">        rc_handle       *rh;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Not needed if you already used openlog() */</span></div>
<div class="line">        <a id="a1" name="a1"></a><a class="code hl_function" href="group__misc-api.html#gaba387f2f50c56fb5d6ccfe98bb7f65c7">rc_openlog</a>(<span class="stringliteral">&quot;my-prog-name&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((rh = <a id="a2" name="a2"></a><a class="code hl_function" href="group__radcli-api.html#ga9ada72729c8cae6ed97c6d0626ee7d62">rc_read_config</a>(RC_CONFIG_FILE)) == NULL)</div>
<div class="line">                <span class="keywordflow">return</span> ERROR_RC;</div>
<div class="line"> </div>
<div class="line">        strcpy(username, <span class="stringliteral">&quot;my-username&quot;</span>);</div>
<div class="line">        strcpy(passwd, <span class="stringliteral">&quot;my-password&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        send = NULL;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Fill in User-Name</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a3" name="a3"></a><a class="code hl_function" href="group__radcli-api.html#gae45147db97e1e7ddc4a97fbee46e64e5">rc_avpair_add</a>(rh, &amp;send, <a id="a4" name="a4"></a><a class="code hl_enumvalue" href="group__radcli-api.html#ggaead935421b5583457637004ac1ce712cadc18eb247fba5387afc2e37a059b60eb">PW_USER_NAME</a>, username, -1, 0) == NULL)</div>
<div class="line">                <span class="keywordflow">return</span> ERROR_RC;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Fill in User-Password</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__radcli-api.html#gae45147db97e1e7ddc4a97fbee46e64e5">rc_avpair_add</a>(rh, &amp;send, <a id="a5" name="a5"></a><a class="code hl_enumvalue" href="group__radcli-api.html#ggaead935421b5583457637004ac1ce712caebe44e88f49622d2255c1af74c153932">PW_USER_PASSWORD</a>, passwd, -1, 0) == NULL)</div>
<div class="line">                <span class="keywordflow">return</span> ERROR_RC;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Fill in Service-Type</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        service = PW_AUTHENTICATE_ONLY;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__radcli-api.html#gae45147db97e1e7ddc4a97fbee46e64e5">rc_avpair_add</a>(rh, &amp;send, <a id="a6" name="a6"></a><a class="code hl_enumvalue" href="group__radcli-api.html#ggaead935421b5583457637004ac1ce712ca79ef0f7a811f9196dd2202e5bfc405f3">PW_SERVICE_TYPE</a>, &amp;service, -1, 0) == NULL)</div>
<div class="line">                <span class="keywordflow">return</span> ERROR_RC;</div>
<div class="line"> </div>
<div class="line">        result = <a id="a7" name="a7"></a><a class="code hl_function" href="group__radcli-api.html#ga26347235362b13b4530593e6bd5571de">rc_auth</a>(rh, 0, send, &amp;received, NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (result == OK_RC) {</div>
<div class="line">                <a class="code hl_struct" href="structrc__value__pair.html">VALUE_PAIR</a> *vp = received;</div>
<div class="line">                <span class="keywordtype">char</span> name[128];</div>
<div class="line">                <span class="keywordtype">char</span> value[128];</div>
<div class="line"> </div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;\&quot;%s\&quot; RADIUS Authentication OK\n&quot;</span>, username);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">/* print the known attributes in the reply */</span></div>
<div class="line">                <span class="keywordflow">while</span>(vp != NULL) {</div>
<div class="line">                        <span class="keywordflow">if</span> (<a id="a8" name="a8"></a><a class="code hl_function" href="group__radcli-api.html#ga77f9da4f29bffb60ad29c160a0fcbed7">rc_avpair_tostr</a>(rh, vp, name, <span class="keyword">sizeof</span>(name), value, <span class="keyword">sizeof</span>(value)) == 0) {</div>
<div class="line">                                fprintf(stderr, <span class="stringliteral">&quot;%s:\t%s\n&quot;</span>, name, value);</div>
<div class="line">                        }</div>
<div class="line">                        vp = vp-&gt;<a id="a9" name="a9"></a>next;</div>
<div class="line">                }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;\&quot;%s\&quot; RADIUS Authentication failure (RC=%i)\n&quot;</span>, username, result);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__misc-api_html_gaba387f2f50c56fb5d6ccfe98bb7f65c7"><div class="ttname"><a href="group__misc-api.html#gaba387f2f50c56fb5d6ccfe98bb7f65c7">rc_openlog</a></div><div class="ttdeci">void rc_openlog(char const *ident)</div><div class="ttdef"><b>Definition</b> <a href="log_8c_source.html#l00036">log.c:36</a></div></div>
<div class="ttc" id="agroup__radcli-api_html_ga26347235362b13b4530593e6bd5571de"><div class="ttname"><a href="group__radcli-api.html#ga26347235362b13b4530593e6bd5571de">rc_auth</a></div><div class="ttdeci">int rc_auth(rc_handle *rh, uint32_t nas_port, VALUE_PAIR *send, VALUE_PAIR **received, char *msg)</div><div class="ttdef"><b>Definition</b> <a href="buildreq_8c_source.html#l00235">buildreq.c:235</a></div></div>
<div class="ttc" id="agroup__radcli-api_html_ga77f9da4f29bffb60ad29c160a0fcbed7"><div class="ttname"><a href="group__radcli-api.html#ga77f9da4f29bffb60ad29c160a0fcbed7">rc_avpair_tostr</a></div><div class="ttdeci">int rc_avpair_tostr(rc_handle const *rh, VALUE_PAIR *pair, char *name, int ln, char *value, int lv)</div><div class="ttdef"><b>Definition</b> <a href="avpair_8c_source.html#l00831">avpair.c:831</a></div></div>
<div class="ttc" id="agroup__radcli-api_html_ga9ada72729c8cae6ed97c6d0626ee7d62"><div class="ttname"><a href="group__radcli-api.html#ga9ada72729c8cae6ed97c6d0626ee7d62">rc_read_config</a></div><div class="ttdeci">rc_handle * rc_read_config(char const *filename)</div><div class="ttdef"><b>Definition</b> <a href="config_8c_source.html#l00568">config.c:568</a></div></div>
<div class="ttc" id="agroup__radcli-api_html_gae45147db97e1e7ddc4a97fbee46e64e5"><div class="ttname"><a href="group__radcli-api.html#gae45147db97e1e7ddc4a97fbee46e64e5">rc_avpair_add</a></div><div class="ttdeci">VALUE_PAIR * rc_avpair_add(rc_handle const *rh, VALUE_PAIR **list, uint32_t attrid, void const *pval, int len, uint32_t vendorspec)</div><div class="ttdef"><b>Definition</b> <a href="avpair_8c_source.html#l00046">avpair.c:46</a></div></div>
<div class="ttc" id="agroup__radcli-api_html_ggaead935421b5583457637004ac1ce712ca79ef0f7a811f9196dd2202e5bfc405f3"><div class="ttname"><a href="group__radcli-api.html#ggaead935421b5583457637004ac1ce712ca79ef0f7a811f9196dd2202e5bfc405f3">PW_SERVICE_TYPE</a></div><div class="ttdeci">@ PW_SERVICE_TYPE</div><div class="ttdoc">Its type is integer.</div><div class="ttdef"><b>Definition</b> <a href="radcli_8h_source.html#l00151">radcli.h:151</a></div></div>
<div class="ttc" id="agroup__radcli-api_html_ggaead935421b5583457637004ac1ce712cadc18eb247fba5387afc2e37a059b60eb"><div class="ttname"><a href="group__radcli-api.html#ggaead935421b5583457637004ac1ce712cadc18eb247fba5387afc2e37a059b60eb">PW_USER_NAME</a></div><div class="ttdeci">@ PW_USER_NAME</div><div class="ttdoc">Its type is string.</div><div class="ttdef"><b>Definition</b> <a href="radcli_8h_source.html#l00146">radcli.h:146</a></div></div>
<div class="ttc" id="agroup__radcli-api_html_ggaead935421b5583457637004ac1ce712caebe44e88f49622d2255c1af74c153932"><div class="ttname"><a href="group__radcli-api.html#ggaead935421b5583457637004ac1ce712caebe44e88f49622d2255c1af74c153932">PW_USER_PASSWORD</a></div><div class="ttdeci">@ PW_USER_PASSWORD</div><div class="ttdoc">Its type is string.</div><div class="ttdef"><b>Definition</b> <a href="radcli_8h_source.html#l00147">radcli.h:147</a></div></div>
<div class="ttc" id="astructrc__value__pair_html"><div class="ttname"><a href="structrc__value__pair.html">rc_value_pair</a></div><div class="ttdef"><b>Definition</b> <a href="radcli_8h_source.html#l00478">radcli.h:479</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
