<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Radcli library: TLS/DTLS API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Radcli library<span id="projectnumber">&#160;1.4.0</span>
   </div>
   <div id="projectbrief">A simple radius library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">TLS/DTLS API</div></div>
</div><!--header-->
<div class="contents">

<p>TLS and DTLS related functions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga846c5da1de8f5b8c2de818b960e157d2" id="r_ga846c5da1de8f5b8c2de818b960e157d2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga846c5da1de8f5b8c2de818b960e157d2">DEFAULT_DTLS_SECRET</a>&#160;&#160;&#160;&quot;radius/dtls&quot;</td></tr>
<tr class="separator:ga846c5da1de8f5b8c2de818b960e157d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d77d38c6376b85ad0acd194aaff750c" id="r_ga2d77d38c6376b85ad0acd194aaff750c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2d77d38c6376b85ad0acd194aaff750c">DEFAULT_TLS_SECRET</a>&#160;&#160;&#160;&quot;radsec&quot;</td></tr>
<tr class="separator:ga2d77d38c6376b85ad0acd194aaff750c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3bac5cb27fda8547d6f0d0d0ac5992a0" id="r_ga3bac5cb27fda8547d6f0d0d0ac5992a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3bac5cb27fda8547d6f0d0d0ac5992a0">TIME_ALIVE</a>&#160;&#160;&#160;120</td></tr>
<tr class="separator:ga3bac5cb27fda8547d6f0d0d0ac5992a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaa948e10a6838e86122f25fbd077313d2" id="r_gaa948e10a6838e86122f25fbd077313d2"><td class="memItemLeft" align="right" valign="top"><a id="gaa948e10a6838e86122f25fbd077313d2" name="gaa948e10a6838e86122f25fbd077313d2"></a>
typedef struct tls_int_st&#160;</td><td class="memItemRight" valign="bottom"><b>tls_int_st</b></td></tr>
<tr class="separator:gaa948e10a6838e86122f25fbd077313d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9da18d7097909d7f7b541e9c870b5667" id="r_ga9da18d7097909d7f7b541e9c870b5667"><td class="memItemLeft" align="right" valign="top"><a id="ga9da18d7097909d7f7b541e9c870b5667" name="ga9da18d7097909d7f7b541e9c870b5667"></a>
typedef struct tls_st&#160;</td><td class="memItemRight" valign="bottom"><b>tls_st</b></td></tr>
<tr class="separator:ga9da18d7097909d7f7b541e9c870b5667"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga349f4bec48db04afa4cddf7d1d9fd0e2" id="r_ga349f4bec48db04afa4cddf7d1d9fd0e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga349f4bec48db04afa4cddf7d1d9fd0e2">rc_tls_fd</a> (rc_handle *rh)</td></tr>
<tr class="separator:ga349f4bec48db04afa4cddf7d1d9fd0e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae799681b16f1bd28305b1818d8ee9d7c" id="r_gae799681b16f1bd28305b1818d8ee9d7c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae799681b16f1bd28305b1818d8ee9d7c">rc_check_tls</a> (rc_handle *rh)</td></tr>
<tr class="separator:gae799681b16f1bd28305b1818d8ee9d7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>TLS and DTLS related functions. </p>
<p>Note that, that API is for improving TLS and DTLS support in an application. Applications are not required to use this API to support them. TLS and DTLS support can be enabled by the administrator transparently from the radiusclient configuration file. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga846c5da1de8f5b8c2de818b960e157d2" name="ga846c5da1de8f5b8c2de818b960e157d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga846c5da1de8f5b8c2de818b960e157d2">&#9670;&#160;</a></span>DEFAULT_DTLS_SECRET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_DTLS_SECRET&#160;&#160;&#160;&quot;radius/dtls&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00052">52</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
<a id="ga2d77d38c6376b85ad0acd194aaff750c" name="ga2d77d38c6376b85ad0acd194aaff750c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2d77d38c6376b85ad0acd194aaff750c">&#9670;&#160;</a></span>DEFAULT_TLS_SECRET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_TLS_SECRET&#160;&#160;&#160;&quot;radsec&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00053">53</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
<a id="ga3bac5cb27fda8547d6f0d0d0ac5992a0" name="ga3bac5cb27fda8547d6f0d0d0ac5992a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3bac5cb27fda8547d6f0d0d0ac5992a0">&#9670;&#160;</a></span>TIME_ALIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_ALIVE&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00393">393</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gae799681b16f1bd28305b1818d8ee9d7c" name="gae799681b16f1bd28305b1818d8ee9d7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae799681b16f1bd28305b1818d8ee9d7c">&#9670;&#160;</a></span>rc_check_tls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_check_tls </td>
          <td>(</td>
          <td class="paramtype">rc_handle *</td>          <td class="paramname"><span class="paramname"><em>rh</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check established TLS/DTLS channels for operation</p>
<p>This function will check whether the channel(s) established for TLS or DTLS are operational, and will re-establish the channel if necessary. If this function fails then the TLS or DTLS state should be considered as disconnected. It must be called at a time when the sessions are not in usage (e.g., in a different thread).</p>
<p>Note: It is recommended to run this function periodically if you have a DTLS channel since an undetected server reset may result to a black hole behavior of the server.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rh</td><td>a handle to parsed configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00464">464</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
<a id="ga349f4bec48db04afa4cddf7d1d9fd0e2" name="ga349f4bec48db04afa4cddf7d1d9fd0e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga349f4bec48db04afa4cddf7d1d9fd0e2">&#9670;&#160;</a></span>rc_tls_fd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_tls_fd </td>
          <td>(</td>
          <td class="paramtype">rc_handle *</td>          <td class="paramname"><span class="paramname"><em>rh</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the file descriptor of the TLS/DTLS session</p>
<p>This can also be used as a test for the application to see whether TLS or DTLS are in use.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rh</td><td>a handle to parsed configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the file descriptor used by the TLS session, or -1 on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="tls_8c_source.html#l00433">433</a> of file <a class="el" href="tls_8c_source.html">tls.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
